{% extends 'website/base.html' %}

{% load static %}

{% block custom_css %}
div > .alert {
  margin-top: 25px;
  text-align: center;
}
.edit, .delete {
  font-size: 25px;
  margin-right: 5px;
}

.info-box {
  background-color: white;
}

.info-box:hover {
  cursor: pointer;
  background-color: #f3f4f5;
}

.highlighted {
  -webkit-box-shadow: 0px 0px 75px 50px rgba(0,136,255,1);
  -moz-box-shadow: 0px 0px 75px 50px rgba(0,136,255,1);
  box-shadow: 0px 0px 75px 50px rgba(0,136,255,1);
}
{% endblock custom_css %}


{% block content %}
    <div class="col-12">
      <span class="m-0 text-dark">Your Profiles</span>
      <a href="{% url 'macros:add_profile' %}">
        <button id="add-profile" type="button" class="btn btn-success" name="button">Add Profile</button>
      </a>
      <br>
      (Click a profile to set it as your current profile)
      <br><br>
    </div>
    {% for profile in profiles %}
    <div class="col-12 col-sm-6 col-md-3">
      <div class="info-box action-link" href="{% url 'macros:set_current_profile' pk=profile.pk %}">
        <span class="info-box-icon bg-info elevation-1" style="background-color: #{{ profile.color }} !important;">
          <i class="{{ profile.icon }}"></i>
        </span>

        <div class="info-box-content">
          <span class="info-box-text">
              {{ profile.name }}
              <i class="fas fa-pencil-alt edit action-link animated item" href="{% url 'macros:update_profile' pk=profile.pk %}" style="margin-left:5px;"></i>
              <i class="fas fa-trash-alt delete action-link animated item" href="{% url 'macros:delete_profile' pk=profile.pk %}"></i>
          </span>
          <span class="info-box-number">
            Recordings:
            <small>{{ profile.get_recordings|length }}</small>
          </span>
        </div>
        <!-- /.info-box-content -->
      </div>
      <!-- /.info-box -->
    </div>
    {% endfor %}

    <div class="modal fade" id="tutorial-modal" tabindex="-1" role="dialog"  aria-hidden="true">
      <div class="modal-dialog modal-notify modal-info" role="document">
        <!--Content-->
        <div class="modal-content text-center">

          <!--Body-->
          <div class="modal-body">
            <br>
            <h2 id="step-title"></h2>
            <br>
            <img id="modal-img" class="animated rotateIn mb-4" style="max-width:150px;">
            <p id="tutorial-text">

            </p>
          </div>

          <!--Footer-->
          <div class="modal-footer flex-center text-center">
            <a onClick="quit_tutorial()" style="margin-right: 10px;cursor:pointer;">Quit Tutorial</a>
            <a id="prev-btn" onClick="previous_step()" type="button" class="btn btn-outline-danger waves-effect">Prev</a>
            <a id="next-btn" onClick="next_step()" class="btn btn-success">Next</a>
          </div>
        </div>
        <!--/.Content-->
      </div>
    </div>
{% endblock content %}

{% block js %}
  <script type="text/javascript">

      // ----------------------------------------------
      // Dynamic Interface Graphics
      // ----------------------------------------------

      var animationClass = "tada";

      $('.edit').hover(function() {
        $(this).addClass(animationClass);
      });

      $('.edit').mouseout(function() {
        $(this).removeClass(animationClass);
      });

      // ----------------------------------------------

      $('.delete').hover(function() {
        $(this).addClass(animationClass);
      });

      $('.delete').mouseout(function() {
        $(this).removeClass(animationClass);
      });

      // ----------------------------------------------
      // Interactive Tutorial
      // ----------------------------------------------

      var current_step = 0;
      var steps = [
        {
            items_to_highlight: [],
            step_title: "Hi I'm Bob",
            text_to_display: ("<h3>WELCOME TO MY TUTORIAL</h3><br>I'm an elite coding monkey who works with the Repeat After Me guys." +
                              " I've put together this tutorial to help you learn the basic of our awesome software." +
                              "<br><br><h4>Click next to get started!</h4>"),
            image_src: "{% static 'website/images/monkey.png' %}"
        },
        {
            items_to_highlight: ["add-profile"],
            step_title: "PROFILES ARE KEY",
            text_to_display: "Profiles let you group your Macros. Add a profile anytime from your dashboard, or the left sidebar!",
            image_src: "{% static 'website/images/profile.png' %}"
        },
        {
            items_to_highlight: ["dashboard"],
            step_title: "VIEW YOUR PROFILES",
            text_to_display: "Your probably going to want to be able to find your profiles, you can do that in these places!",
            image_src: "{% static 'website/images/profile.png' %}"
        },
        {
            items_to_highlight: [],
            step_title: "SET YOUR CURRENT PROFILE",
            text_to_display: ("In order to play macros you need to set a current profile." +
                             "<br>View your profiles and click on one to set it as your current profile!"),
            image_src: "{% static 'website/images/current-profile.png' %}"
        },
        {
            items_to_highlight: ["token"],
            step_title: "CONNECT YOUR COMPUTER",
            text_to_display: "Next, you'll want to enter your Desktop token into the software downloaded." +
                             " This token is what allows us to uniquely identify your computer." +
                             "<br><br>KEEP IT A SECRET.<br><br>You can find yours where the screen is highlighted!",
            image_src: "{% static 'website/images/token.png' %}"
        },
        {
            items_to_highlight: ["settings"],
            step_title: "CHANGE YOUR SETTINGS",
            text_to_display: "Finally, if you ever want to update your settings you can do so here!",
            image_src: "{% static 'website/images/settings.png' %}"
        },
        {
            items_to_highlight: [],
            step_title: "CREATE YOUR FIRST RECORDING",
            text_to_display: ("You're almost done. Lets try creating your first recording!<br>Click 'Save a Recording' and follow the steps that pop up." +
                              "<br><br><a href=\"{% url 'macros:save_recording' %}\" class='btn btn-success' type='button'>Save a Recording</a>"),
            image_src: "{% static 'website/images/record.png' %}"
        },
      ];

      function restart() {
        current_step = 1;
      }

      function next_step() {
        highlight();
        update_tutorial_modal();
        if(current_step == (steps.length - 1)) {
          $('#next-btn').css('display', 'none');
        } else if(current_step > 0) {
          $('#prev-btn').css('display', 'inline');
        } else {
          $('#prev-btn').css('display', 'none');
        }
        current_step += 1;
      }

      function previous_step() {
        highlight();
        update_tutorial_modal();
        if(current_step > 0) {
          $('#prev-btn').css('display', 'inline');
        } else {
          $('#prev-btn').css('display', 'none');
        }
        current_step -= 1;
      }

      function highlight() {
        var objects = steps[current_step].items_to_highlight;
        for(i=0; i < objects.length; i++) {
          $('#' + objects[i]).addClass('highlighted');
          $('#' + objects[i]).addClass('animated');
          $('#' + objects[i]).addClass('bounce');
        }
      }

      function update_tutorial_modal() {
        $('#step-title').html(steps[current_step].step_title);
        $('#tutorial-text').html(steps[current_step].text_to_display);
        $('#modal-img').attr('src', steps[current_step].image_src);
      }

      function quit_tutorial() {
        if(confirm("The tutorial won't show anymore after this. Are you sure you want to quit it?")) {
          window.location.href = "{% url 'macros:quit_tutorial' %}";
        }
      }

      $(document).ready(function() {
        if("{{settings.offer_tutorial}}" == "True") {
          // Start tutorial for the user
          next_step();
          $('#tutorial-modal').modal('show');
        }
      });
  </script>
{% endblock js %}
